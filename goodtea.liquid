<div id="app">
  <h3 class="heading-step" style="text-align: center;">{{section.settings.step2}}</h3>
  <div class="heading-content" style="text-align: center;">{{section.settings.step2_content}}</div>
  <section class="sectionM" v-if="first_section">
    <div class="modal-wrapper" id="container-modal" style="display:none;">
      <div class="modalss" id="myModal" >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-body">
              <p>Are you sure you want to change your box size from ${size} to ${next_size}?</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn button" data-dismiss="modal" @click="addsizeM()">Yes</button>
              <button type="button" class="btn btn-default" data-dismiss="modal" @click="hidemodel()">No</button>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-backdrop fade in"></div>
    </div>
    <div class="row page-inner Grid custom_product_item_grid bold_option_swatch">
      <div class="custom_product_item Grid__Cell 1/1--phone 1/2--tablet-and-up 1/4--desk" v-for="(selectprodcut, index) in products" :key="index">
        <div class="ProductItem ">
          <div class="ProductItem__Wrapper  bold_option_value">
            <button class="ProductItem__ImageWrapper">
              <div class="editbox-img">
                <img class="ProductItem__Image Image--lazyLoad Image--fadeIn" v-bind:src="selectprodcut.img">
                <span class="Image__Loader"></span>
              </div>
            </button>
            <div class="ProductItem__Info">
              <h2 class="ProductItem__Title Heading">
                <span>${selectprodcut.title}</span>
              </h2>
            </div> 
            <span class="bold_option_swatch_title"><span class="bold_option_value_title" v-html="selectprodcut.des"></span></span>
          </div>
          <button class="ProductItem__ViewButton Button Button--secondary" @click="setNewValue($event,1,selectprodcut)">Add to box</button>
        </div>
      </div>
    </div>
    <div class="sticky-box-contents">
      <div class="row page-inner yourbox" v-if="section1">
        <div class="col-md-8 md7">
          <h5 class="boxh2">Your Box</h5>
          <div class="row box-items" v-if="size <= 5">
            <div class="col-md-12 md12">
              <p v-for="(selctedimgs, ind) in selctedimg" v-bind:class="(selctedimgs.value) ? 'added' : ''">
                <img class="selected-img" v-if="selctedimgs.value" v-bind:src="selctedimgs.value" width="100" height="100">
                <span @click="removefromarray(ind,selctedimgs)" class="adddx" v-if="selctedimgs.value">x</span>
              </p>
            </div>
          </div>
          <!--             <ul class="box-items" > -->
          <div class="row box-items" v-if="size > 5 && size <= 15">
            <div class="col-md-12 md12">
              <p v-for="(selctedimgs, ind) in selctedimg" v-bind:class="(selctedimgs.value) ? 'added' : ''" v-if="ind <= 4">
                <img class="selected-img" v-if="selctedimgs.value" v-bind:src="selctedimgs.value" width="100" height="100">
                <span @click="removefromarray(ind,selctedimgs)" class="adddx" v-if="selctedimgs.value">x</span>
              </p>
            </div>
            <div class="col-md-12 md12">
              <p v-for="(selctedimgs, ind) in selctedimg" v-bind:class="(selctedimgs.value) ? 'added' : ''" v-if="ind > 4 && ind <= 9">
                <img class="selected-img" v-if="selctedimgs.value" v-bind:src="selctedimgs.value" width="100" height="100">
                <span @click="removefromarray(ind,selctedimgs)" class="adddx" v-if="selctedimgs.value">x</span>
              </p>
            </div>
            <div class="col-md-12 md12">
              <p v-for="(selctedimgs, ind) in selctedimg" v-bind:class="(selctedimgs.value) ? 'added' : ''" v-if="ind > 9 && ind <= 14">
                <img class="selected-img" v-if="selctedimgs.value" v-bind:src="selctedimgs.value" width="100" height="100">
                <span @click="removefromarray(ind,selctedimgs)" class="adddx" v-if="selctedimgs.value">x</span>
              </p>
            </div>
          </div>
          <!--             </ul> -->
          <div class="row box-items" v-if="size > 15">
            <div class="col-md-12 md12">
              <p v-for="(selctedimgs, ind) in selctedimg" v-bind:class="(selctedimgs.value) ? 'added' : ''" v-if="ind <= 5">
                <img class="selected-img" v-if="selctedimgs.value" v-bind:src="selctedimgs.value" width="100" height="100">
                <span @click="removefromarray(ind,selctedimgs)" class="adddx" v-if="selctedimgs.value">x</span>
              </p>
            </div>
            <div class="col-md-12 md12">
              <p v-for="(selctedimgs, ind) in selctedimg" v-bind:class="(selctedimgs.value) ? 'added' : ''" v-if="ind > 5 && ind <= 11">
                <img class="selected-img" v-if="selctedimgs.value" v-bind:src="selctedimgs.value" width="100" height="100">
                <span @click="removefromarray(ind,selctedimgs)" class="adddx" v-if="selctedimgs.value">x</span>
              </p>
            </div>
            <div class="col-md-12 md12">
              <p v-for="(selctedimgs, ind) in selctedimg" v-bind:class="(selctedimgs.value) ? 'added' : ''" v-if="ind > 11 && ind <= 17">
                <img class="selected-img" v-if="selctedimgs.value" v-bind:src="selctedimgs.value" width="100" height="100">
                <span @click="removefromarray(ind,selctedimgs)" class="adddx" v-if="selctedimgs.value">x</span>
              </p>
            </div>
          </div>
        </div>
        <div class="col-md-4 md4 mobile-md4">
          <div v-bind:class="(size === '10' && handles == 'wooden-box-10-tubes') ? 'row yourbox desktop-view padng' : 'row yourbox desktop-view'">
            <div v-bind:class="(size === '10' && handles == 'wooden-box-10-tubes') ? 'col-md-4 md4 sizes active' : 'col-md-4 md4 sizes'">
              <p v-if="product1.length > 0"  @click="addsize('10','wooden-box-10-tubes')"> 10 items</p>
              <p class="mobile-hide " v-if="size === '10' && handles == 'wooden-box-10-tubes'"><span>Dhs.</span>${price}</p>
            </div>
            <div v-bind:class="(size === '15') ? 'col-md-4 md4 sizes active' : 'col-md-4 md4 sizes'">
              <p v-if="product2.length > 0" @click="addsize('15','15-items-in-your-box')">15 items</p>
              <p class="mobile-hide" v-if="size === '15'"><span>Dhs.</span>${price}</p>
            </div>
            <div v-bind:class="(size === '10' && handles == 'leather-box-10-tubes') ? 'col-md-4 md4 sizes active' : 'col-md-4 md4 sizes'">
              <p v-if="product3.length > 0" @click="addsize('10','leather-box-10-tubes')">10 items</p>
              <p class="mobile-hide" v-if="size === '10' && handles == 'leather-box-10-tubes'"><span>Dhs.</span>${price}</p>
            </div>
          </div>
          <div v-bind:class="(size === '10') ? 'row yourbox mobile-view padng' : 'row yourbox mobile-view'">
            <div class="col-md-4 md4 sizes">
<!--               <p @click="addsizeformobm(size)"><span class="puls">-<i class="fa fa-plus" aria-hidden="true"></i></span></p> -->

            </div>
            <div class="col-md-4 md4 sizes">
              <p><span class="ite_ms">${size}</span></p>
              <p class="mobile-hid"><span>Dhs.</span>${price}</p>
            </div>
            <div class="col-md-4 md4 sizes">
<!--               <p @click="addsizeformobp(size)"><span class="mim">+<i class="fa fa-minus" aria-hidden="true"></i> </span></p> -->
            </div>
          </div>
          <div class="row yourbox">
            <button class="btn button buy-now mobile_btn" @click="gotocart($event)" >
              BUY NOW
            </button>
          </div>
        </div>
      </div>
      <!--     <div class="row page-inner yourbox" v-else>
<div class="col-md-8 md7">
Your ${size} items box
</div>
<div class="col-md-4 md4">
<p><span>$</span>${price}</p>
<button class="btn button buy-now" @click="gotocart($event)" >
PROCEED
</button>
</div>
</div> -->
    </div>
  </section>
  <section class="sectionD" v-if="secnd_sctn">
    <div class="Product__Info ">
      <div class="ProductMeta">
        <!--        <h1 class="ProductMeta__Title Heading u-h2">Discovery Box</h1> -->
        <div class="box-size" v-if="size == 10">
          Box Size: ${size} Tubes (~20 servings)
        </div>
        <div class="box-size" v-else>
          Box Size: ${size} Tubes (~30 servings)
        </div>
      </div>
      <form method="post" action="#" id="cartform" class="ProductForm" accept-charset="UTF-8" enctype="multipart/form-data">
        <input type="hidden" name="utf8" id="utf8" value="âœ“">
        <div class="bold_options bold_options_loaded">
          <div class="bold_option_set">
            <div class="bold_option bold_option_textbox" v-if="handles != 'leather-box-10-tubes'">
              <label>
                <span class="bold_option_title">
                  Name on the Box*
                </span>
                <span class="bold_option_element">
                  <input name="NameBox" type="text" v-model="NameBox">
                </span>
              </label>
            </div>
            <div class="bold_option bold_option_swatch" v-if="handles == '15-items-in-your-box' || handles == 'leather-box-10-tubes'">
              <span class="bold_option_title">Box Color*</span>
              <span class="bold_option_element" v-if="size == 10">
                <span class="bold_option_value"  v-for="(discover, index) in discoverLather" :key="index">	
                  <label>
                    <span class="bold_option_value_element">
                      <span class="bold_option_value_swatch">
                        <span :style="{ backgroundImage: `url(${discover.image})`}"></span>
                      </span>
                      <input type="checkbox"  @click="setboxcolor($event,discover);" class="discover" value="discover.name" data-option_value_key="index">
                    </span>
                    <span class="bold_option_swatch_title">
                      <span class="bold_option_value_title">${discover.name}</span>
<!--                       <span class="bold_option_value_price" v-if="discover.name !== 0.00"><span class="money">Dhs.${discover.price}</span></span> -->
                    </span>
                  </label>
                </span>
                </span>
              <span class="bold_option_element" v-if="size == 15">
                <span class="bold_option_value" v-for="(discover, index) in discoverbox" :key="index">
                  <label>
                    <span class="bold_option_value_element">
                      <span class="bold_option_value_swatch">
                        <span :style="{ backgroundImage: `url(${discover.image})`}"></span>
                      </span>
                      <input type="checkbox"  @click="setboxcolor($event,discover);" class="discover" value="discover.name" data-option_value_key="index">
                    </span>
                    <span class="bold_option_swatch_title">
                      <span class="bold_option_value_title">${discover.name}</span>
<!--                       <span class="bold_option_value_price" v-if="discover.name !== 0.00"><span class="money">Dhs.${discover.price}</span></span> -->
                    </span>
                  </label>
                </span>
              </span> 
            </div>
            <div class="bold_option bold_option_checkbox" v-if="size == 10 && handles == 'leather-box-10-tubes'">
              <label>
                <span class="bold_option_element">
                  <input type="checkbox" class="cb_1185907_478609" v-model="CustomTubes" @change="showNameOfBox($event)">
                </span>
                <span class="bold_option_title">Would you like to personalize the box? (Gold color engraving) Dhs. 39.00</span>

                <span class="bold_option_value_price"><span class="money" data-currency-aed=""></span></span>
              </label>
              <div class="bold_option bold_option_textbox" style="display:none;">
              <label>
                <span class="bold_option_title">
                  Name on the Box*
                </span>
                <span class="bold_option_element">
                  <input name="NameBox" type="text" v-model="NameBox">
                </span>
              </label>
            </div>
            </div>
            
<!--             <div class="bold_option bold_option_checkbox">
              <label>
                <span class="bold_option_element">
                  <input type="checkbox" class="cb_1185907_478609" v-model="CustomTubes">
                </span>
                <span class="bold_option_title">Custom Tubes: Add Name &amp; Quotes Dhs. 29.00</span>

                <span class="bold_option_value_price"><span class="money" data-currency-aed=""></span></span>
              </label>
            </div> -->
            <div class="bold_option bold_option_swatch" v-if="size > 18">
              <span class="bold_option_title">Add Tea Accessories:</span>
              <span class="bold_option_element tea-accessories">
                <span class="bold_option_value " v-for="(infuser, index) in seconddescover" :key="infuser.name">
                  <label>
                    <span class="bold_option_value_element">
                      <span class="bold_option_value_swatch">
                        <span :style="{ backgroundImage: `url(${infuser.image})` }"></span>
                      </span>
                      <input type="checkbox" @click="settesaccss($event,1,infuser);" class="swm_infuser" :value="infuser.name" data-option_value_key="index">
                    </span>
                    <span class="bold_option_swatch_title">
                      <span class="bold_option_value_title">${infuser.name}</span>
                      <span class="bold_option_value_price"><span class="money" data-currency-aed="">${infuser.price}</span></span>
                    </span>
                  </label>
                </span>
              </span>
            </div>
          </div>
        </div>
        <button type="button" class="Button Button--secondary " @click="addtocart($event)"><span>Add to cart</span></button>
      </form>
    </div>
  </section>
</div>
<script>
  var product = {{ product | json }};
  var productname = {{ product.title | json }};
  var size = 0;
  var price = {{ product.variants[0].price }};
  price = price/100;
  var variant ={{product.variants[0].id}};
  var productOptions = [];
  var options = {{product.options_with_values | json}};
  for(var i=0;i < options.length; i++ ){
    if(options[i].name == 'Size' || options[i].name == 'size'){
      size = options[i].values[0];
    }
  }
    var handles = '';
    if(__st.pageurl.includes('leather-box-10-tubes')){
      handles = 'leather-box-10-tubes';
  }
    if(__st.pageurl.includes('15-items-in-your-box')){
      handles = '15-items-in-your-box';
  }
    if(__st.pageurl.includes('wooden-box-10-tubes')){
      handles = 'wooden-box-10-tubes';
  }
  console.log(handles);
  //First product
  var size1 =0;
  var size2=0;
  var size3= 0;
  var product1 =[];
  var product2 =[];
  var product3 =[];
//   $.getJSON('/collections/build-box-products/products.json?limit=250', function(response) {
//     var productList = response;
//     $(productList.products).each(function(index){ 
//       var value2 ={
//         'title':this.title,
//         'img': this.images[0].src,
//       }
//       products.push(value2);
//     });
  //});
    //if(product.handle == '5-items-in-your-box'){
     // var product1 =[];
     $.getJSON('/products/wooden-box-10-tubes', function(response) {
       product1.push(response.product);
       if(response.product.length > 0){
       	 var options =response.product.options_with_values;
         for(var i=0;i < options.length; i++ ){
           if(options[i].name == 'Size' || options[i].name == 'size'){
             size1 = options[i].values[0];
           }
         }
       }
     });
   // }
    //second product
  //  if(product.handle =='15-items-in-your-box'){
    //var prodcut2 = [];
    jQuery.getJSON('/products/15-items-in-your-box', function(response) {
      	product2.push(response.product);
      	if(response.product.length > 0){
          var options =response.product.options_with_values;
          for(var i=0;i < options.length; i++ ){
           if(options[i].name == 'Size' || options[i].name == 'size'){
             size2 = options[i].values[0];
             console.log(size2);
           }
         }
        }
   });
   // }
    //third product
   // if(product.handle =='leather-box-10-tubes'){
    //  var product3= [];
    $.getJSON('/products/leather-box-10-tubes', function(response) {
        product3.push(response.product);
      	if(response.product.length > 0){
          var options =response.product.options_with_values;
          for(var i=0;i < options.length; i++ ){
           if(options[i].name == 'Size' || options[i].name == 'size'){
             size3 = options[i].values[0];
           }
         }
        }
        });
  
  //  }
//   console.log(product1);
//   console.log(product2);
//   console.log(product3);
//   console.log(size1);
//   console.log(size2);
//   console.log(size3);
  if(size == '5'){
    next_size = '15';
  }else if(size == '15'){
    next_size = '18';
  }else{
    next_size = '5';
  }
  var hidden_product= [];
  {% if section.settings.a_c != blank %}
  $.getJSON('/collections/{{section.settings.a_c}}/products.json?limit=250', function(obj) {
    // console.log(obj);
    // Build List
    $(obj.products).each(function(index){
      // if(product.product_type== 'OPTIONS_HIDDEN_PRODUCT'){
      // console.log(product);
      //  console.log(product.images);
      //   var img ='';
      //   if(product.images.lenght > 0){
      var value2 ={
        'id': this.id,
        'name':this.title,
        'image': this.images[0].src,
        'price': this.variants[0].price,
        'variant_id': this.variants[0].id,
        'variant_title': this.variants[0].title
      }
      hidden_product.push(value2);
      //}
      //  }
      // hasMatch(tags, product);
    });
  });
  {% else %}
  $.getJSON('/collections/add-accessory/products.json?limit=250', function(obj) {
   //  console.log(obj);
    // Build List
    $(obj.products).each(function(index){
      // if(product.product_type== 'OPTIONS_HIDDEN_PRODUCT'){
      // console.log(product);
      //  console.log(product.images);
      //   var img ='';
      //   if(product.images.lenght > 0){
      var value2 ={
        'id': this.id,
        'name':this.title,
        'image': this.images[0].src,
        'price': this.variants[0].price,
        'variant_id': this.variants[0].id,
        'variant_title': this.variants[0].title
      }
      hidden_product.push(value2);
      //}
      //  }
      // hasMatch(tags, product);
    });
  });
  {% endif %}
  //console.log(hidden_product);
  productOptions.push(size);
  var products = [];
  //tea-party-gifts-for-guests
  //flavored-tea
  {% if section.settings.c1 != blank %}
  $.getJSON('/collections/{{section.settings.c1}}/products.json?limit=250', function(response) {
    var productList = response;
    //console.log(productList.products);
    $(productList.products).each(function(index){ 
      var check = products.find(x => x.id == this.id);
    if(check == undefined){
      var value2 ={
        'id': this.id,
        'title':this.title,
        'img': this.images[0].src,
        'des' : this.body_html     
      }
      products.push(value2);
    }
    }); 
  });
  {% endif %}
   {% unless section.settings.c1 != blank or section.settings.c2 != blank or section.settings.c3 != blank or section.settings.c4 != blank or section.settings.c5 != blank or section.settings.c6 != blank or section.settings.c7 != blank or section.settings.c8 != blank %}
  $.getJSON('/collections/flavored-tea/products.json?limit=250', function(response) {
    var productList = response;
    //console.log(productList.products);
    $(productList.products).each(function(index){ 
     var check = products.find(x => x.id == this.id);
    if(check == undefined){
      var value2 ={
        'id': this.id,
        'title':this.title,
        'img': this.images[0].src,
        'des' : this.body_html
      }
      products.push(value2);
    }
    }); 
  });
  {% endunless %}
  {% if section.settings.c2 != blank %}
  $.getJSON('/collections/{{section.settings.c2}}/products.json?limit=250', function(response) {
    var productList = response;
    //console.log(productList.products);
    $(productList.products).each(function(index){ 
     var check = products.find(x => x.id == this.id);
    if(check == undefined){
      var value2 ={
        'id': this.id,
        'title':this.title,
        'img': this.images[0].src,
        'des' : this.body_html
      }
      products.push(value2);
    }
    }); 
  });
  {% endif %}
  {% if section.settings.c3 != blank %}
  $.getJSON('/collections/{{section.settings.c3}}/products.json?limit=250', function(response) {
    var productList = response;
    //console.log(productList.products);
    $(productList.products).each(function(index){ 
     var check = products.find(x => x.id == this.id);
    if(check == undefined){
      var value2 ={
        'id': this.id,
        'title':this.title,
        'img': this.images[0].src,
        'des' : this.body_html    
      }
      products.push(value2);
    }
    }); 
  });
  {% endif %}
  {% if section.settings.c4 != blank %}
  $.getJSON('/collections/{{section.settings.c4}}/products.json?limit=250', function(response) {
    var productList = response;
    //console.log(productList.products);
    $(productList.products).each(function(index){ 
     var check = products.find(x => x.id == this.id);
    if(check == undefined){
      var value2 ={
        'id': this.id,
        'title':this.title,
        'img': this.images[0].src,
        'des' : this.body_html
      }
      products.push(value2);
    }
    }); 
  });
  {% endif %}
  {% if section.settings.c5 != blank %}
  $.getJSON('/collections/{{section.settings.c5}}/products.json?limit=250', function(response) {
    var productList = response;
    //console.log(productList.products);
    $(productList.products).each(function(index){ 
     var check = products.find(x => x.id == this.id);
    if(check == undefined){
      var value2 ={
        'id': this.id,
        'title':this.title,
        'img': this.images[0].src,
        'des' : this.body_html
      }
      products.push(value2);
    }
    }); 
  });
  {% endif %}
  {% if section.settings.c6 != blank %}
  $.getJSON('/collections/{{section.settings.c6}}/products.json?limit=250', function(response) {
    var productList = response;
    //console.log(productList.products);
    $(productList.products).each(function(index){ 
     var check = products.find(x => x.id == this.id);
    if(check == undefined){
      var value2 ={
        'id': this.id,
        'title':this.title,
        'img': this.images[0].src,
        'des' : this.body_html
      }
      products.push(value2);
    }
    }); 
  });
  {% endif %}
  {% if section.settings.c7 != blank %}
  $.getJSON('/collections/{{section.settings.c7}}/products.json?limit=250', function(response) {
    var productList = response;
    //console.log(productList.products);
    $(productList.products).each(function(index){ 
     var check = products.find(x => x.id == this.id);
    if(check == undefined){
      var value2 ={
        'id': this.id,
        'title':this.title,
        'img': this.images[0].src,
        'des' : this.body_html
      }
      products.push(value2);
    }
    }); 
  });
  {% endif %}
  {% if section.settings.c8 != blank %}
  $.getJSON('/collections/{{section.settings.c8}}/products.json?limit=250', function(response) {
    var productList = response;
    //console.log(productList.products);
    $(productList.products).each(function(index){ 
     var check = products.find(x => x.id == this.id);
    if(check == undefined){
      var value2 ={
        'id': this.id,
        'title':this.title,
        'img': this.images[0].src,
        'des' : this.body_html
      }
      products.push(value2);
    }
    }); 
  });
  {% endif %}
  var selctedimg =[];
  for(var d=0;d < size; d++ ){
    selctedimg.push({'name': d, 'value': ''});
  }
   console.log(products);
  var app =new Vue({
    delimiters: ['${', '}'],
    el: '#app',
    data: {
      size:size,
      products: products,
      secnd_sctn:false,
      first_section:true,
      product1 : product1,
      product2: product2,
      product3: product3,
      product_size1:size1,
      product_size2:size2,
      product_size3:size3,
      d_title:'',
      selecteditmno:0,
      product: [],
      selectedproduct: [],
      count: '',
      varobj:'',
      selctedimg:selctedimg,
      variant_id: variant,
      product_name: productname,
      price: price,
      next_size: next_size,
      Box_Color: '',
      Box_Color_id: '',
      NameBox:'',
      CustomTubes: false,
      section1: true,
      modal: false,
      AddTeaAccessories: [],
      checkBox: false,
      discoverbox: [
                   {
                      id: 4595782778926,
                      variant_id: 32405635072046,
                      name: 'Bright Orange',
                      image: 'https://cdn.shopify.com/s/files/1/0244/4620/5998/files/388bb73f6f938a23021b4b02bc7e43ed.jpeg?v=1600404404',
                      price: '0.00'
                    },
                    {
                      id: 4598117531694,
                      variant_id: 32416640303150,
                      name: 'Mustard Yellow',
                      image: 'https://cdn.shopify.com/s/files/1/0244/4620/5998/files/8a09ffa0913f9b1b76435d366842c5dd.jpeg?v=1600404403',
                      price: '0.00'
                    },
                    {
                      id: 4595782778926,
                      variant_id: 32405635366958,
                      name: 'Olive Green',
                      image: 'https://cdn.shopify.com/s/files/1/0244/4620/5998/files/olivegreen.jpeg?v=1600404404',
                      price: '0.00'
                    },
                    {
                      id: 4598117531694,
                      variant_id: 32416640237614,
                      name: 'Tiffany Blue',
                      image: 'https://cdn.shopify.com/s/files/1/0244/4620/5998/files/tiffanyblue.jpeg?v=1600404404',
                      price: '10.00'
                    },{
                      id: 4612340482094,
                      variant_id: 32479465537582,
                      name: 'Deep Pink',
                      image: 'https://cdn.shopify.com/s/files/1/0244/4620/5998/files/deeppink.jpeg?v=1600404403',
                      price: '15.00'
                    },
                    {
                      id: 4595782778926,
                      variant_id: 32405635170350,
                      name: 'Coral Red',
                      image: 'https://cdn.shopify.com/s/files/1/0244/4620/5998/files/coralred.jpeg?v=1600404404',
                      price: '25.00'
                    },
                    {
                      id: 4595782778926,
                      variant_id: 32405635104814,
                      name: 'Baby Pink',
                      image: 'https://cdn.shopify.com/s/files/1/0244/4620/5998/files/babypink.jpeg?v=1600404404',
                      price: '25.00'
                    },
                    {
                      id: 4617194504238,
                      variant_id: 32506563690542,
                      name: 'Lavender',
                      image: 'https://cdn.shopify.com/s/files/1/0244/4620/5998/files/lavender.jpeg?v=1600404404',
                      price: '25.00'
                    },
                    {
                      id: 4636560850990,
                      variant_id: 32602468286510,
                      name: 'Original',
                      image: 'https://cdn.shopify.com/s/files/1/0244/4620/5998/files/original.jpeg?v=1600404404',
                      price: '30.00'
                    }],
      discoverbox18: [{
                      id: 4595782778926,
                      variant_id: 32405635072046,
                      name: 'Aqua Blue',
                      image: 'https://cdn.shopify.com/s/files/1/0244/4620/5998/files/image_2020_10_22T05_11_24_462Z.png?v=1603347795',
                      price: '0.00'
                    },
                    {
                      id: 4595782778926,
                      variant_id: 32405635366958,
                      name: 'Olive Green',
                      image: 'https://cdn.shopify.com/s/files/1/0244/4620/5998/files/image_2020_10_22T05_11_13_727Z.png?v=1603351021',
                      price: '0.00'
                    },
                    {
                      id: 4595782778926,
                      variant_id: 32405635104814,
                      name: 'Baby Pink',
                      image: 'https://cdn.shopify.com/s/files/1/0244/4620/5998/files/image_2020_10_22T05_11_19_551Z.png?v=1603351021',
                      price: '0.00'
                    },
                    {
                      id: 4617194504238,
                      variant_id: 32506563690542,
                      name: 'Lavender',
                      image: 'https://cdn.shopify.com/s/files/1/0244/4620/5998/files/image_2020_10_22T05_11_29_401Z.png?v=1603351021',
                      price: '0.00'
                    }],
      discoverLather: [
        {
          id: 1,
          name: 'Camel',
          image: 'https://static.boldcommerce.com/options/swatch/611509/5087ac91933042c5b18f22af56dcc8b6.jpeg'
        },
        {
          id: 2,
          name: 'Burgundy',
          image: 'https://static.boldcommerce.com/options/swatch/611509/6ccc22013358c0a363400e784dfc5431.jpeg'
        },
        {
          id: 3,
          name: 'Crocodile',
          image: 'https://static.boldcommerce.com/options/swatch/611509/2b093d478c6102645ca985b92b190d09.jpeg'
        }],
      handles: handles,
      seconddescover: hidden_product
    },
    methods: {
      addsize: async  function(size,handle) {
        this.handles = handle;
      var Nproduct = [];
      var that = this;
      await jQuery.getJSON('/products/'+handle, function(response) {
      Nproduct = response.product;
      that.variant_id = Nproduct.variants[0].id;
      that.price = Nproduct.variants[0].price;
      that.product_name = Nproduct.title;
    }); 

    if(parseInt(size) < parseInt(this.size)){
      //console.log(this.selecteditmno);
      var ind= this.size - size;
      var inds= this.selecteditmno - size;
      // console.log(ind);
      //console.log(inds);
      this.selctedimg.splice(-ind, ind);
      this.selectedproduct.splice(-inds, inds);
      if(this.selecteditmno > parseInt(size)){
        this.selecteditmno = parseInt(size);
      }
   }else{
    for(var d=0; d < size; d++ ){
      if(this.selctedimg.length <= d){
        this.selctedimg.push({'name': d, 'value': ''});
      } 
    }
  }
        
  // console.log(this.selectedproduct);
  this.size = size; 
  if(size == '5'){
    this.next_size = '15';
  }else if(size == '15'){
    this.next_size = '18';
  }else{
    this.next_size = '5';
  }
  },
    addsizeformobm(value){
      var s='';
      if(value == '15'){
        s = 5;
        this.addsize(s, '5-items-in-your-box');
      }else if(value == '18'){
        s = 15;
        this.addsize(s, '15-items-in-your-box');
      }else{

      }
      //5-items-in-your-box
    },
    addsizeformobp(value){
        var s='';
        if(value == '5'){
          s = 15;
          this.addsize(s, '15-items-in-your-box');
        }else if(value == '15'){
          s = 18;
          this.addsize(s, '18-items-in-your-box');
        }else{

        }
    },
    setNewValue: function(e,value, product) {
          if(parseInt(this.selecteditmno) < parseInt(this.size)){
            if(this.size == '15'){
              for(var a=1; a<=5; a++){
                if(this.selecteditmno < this.selctedimg.length){
                  this.selctedimg[this.selecteditmno].value =product.img;
                  this.selecteditmno += value;
                  this.varobj ={
                    'title':product.title,
                    'img': product.img
                  };
                  this.selectedproduct.push(this.varobj); 
                }
              }
            }else if(this.size == '10'){
               for(var a=1; a<=2; a++){
                if(this.selecteditmno < this.selctedimg.length){
                  this.selctedimg[this.selecteditmno].value =product.img;
                  this.selecteditmno += value;
                  this.varobj ={
                    'title':product.title,
                    'img': product.img
                  };
                  this.selectedproduct.push(this.varobj); 
                }
              }   
            }else if(this.size == '18'){
            	for(var a=1; a<=6; a++){
                if(this.selecteditmno < this.selctedimg.length){
                  this.selctedimg[this.selecteditmno].value =product.img;
                  this.selecteditmno += value;
                  this.varobj ={
                    'title':product.title,
                    'img': product.img
                  };
                  this.selectedproduct.push(this.varobj); 
                }
              }
            }else{
              this.selctedimg[this.selecteditmno].value =product.img;
              this.selecteditmno += value;
              this.count =value;
              this.varobj ={
                'title':product.title,
                'img': product.img
              };
              this.selectedproduct.push(this.varobj); 
            }
          } else{
            if(this.size == '5'){
              if(this.product2.length > 0){
                console.log(this.size);
                // this.modal = true;
                $('#container-modal').show();
                $('#myModal').addClass('modalfade');
                $('.template-product').addClass("scroll");
              }
            }else if(this.size == '15'){
              if(this.product3.length > 0){
              	console.log(this.size);
                // this.modal = true;
                $('#container-modal').show();
                $('#myModal').addClass('modalfade');
                $('.template-product').addClass("scroll");
              }
            }
          }
        },
        addsizeM: function() {
            this.section1=true;
            // this.modal = false;
            $('#container-modal').hide();
            $('#myModal').removeClass('modalfade');
            $('.template-product').removeClass("scroll");
            if(this.next_size == '15'){
              this.addsize(this.next_size, '15-items-in-your-box');
            }else if(this.next_size == '18'){
              this.addsize(this.next_size, '18-items-in-your-box');
            }else{
              //
            }
          },
            removefromarray: function(index, product) {
              if(this.size == '15'){
                for(var a=1; a<=5; a++){
                  if(this.selecteditmno > 0){
                    this.selctedimg.splice(index, 1);
                    this.selectedproduct.splice(index, 1);
                    index --;
                    this.selecteditmno -=1;
                  }
                }
              }else if(this.size == '10'){
                for(var a=1; a<=2; a++){
                  if(this.selecteditmno > 0){
                    this.selctedimg.splice(index, 1);
                    this.selectedproduct.splice(index, 1);
                    index --;
                    this.selecteditmno -=1;
                  }
                }
              }else if(this.size == '18'){
                for(var a=1; a<=6; a++){
                  if(this.selecteditmno > 0){
                    this.selctedimg.splice(index, 1);
                    this.selectedproduct.splice(index, 1);
                    index --;
                    this.selecteditmno -=1;
                  }
                }
              }else{
                this.selectedproduct.splice(index, 1);
                this.selctedimg.splice(index, 1);
                this.selecteditmno -=1;
              }

              for(var d=0; d < this.size; d++ ){
                if(this.selctedimg.length <= d){
                  this.selctedimg.push({'name': d, 'value': ''});
                } 
              }
            },
              hidemodel: function() {
                // this.modal =false;
                $('#container-modal').hide();
                $('#myModal').removeClass('modalfade');
                $('.template-product').removeClass("scroll");
              },
              gotoproceed: function(e) {
                console.log(this.selectedproduct);
                if(this.selecteditmno == this.size){
                  this.section1=false;

                }
              },
              gotocart: function(){
                if(this.selecteditmno == this.size){
                  this.secnd_sctn = true;
                  this.first_section = false;
                  var content_head=`{{section.settings.step3_content}}`;

                  $('.heading-step').text("{{section.settings.step3}}");
                                          $('.heading-content').html(content_head);
                  $(window).scrollTop(0); 
                }
              },
              setboxcolor:function(e,product){
                this.Box_Color = product.name;
               // this.Box_Color_id = product.variant_id;
                $('.bold_option_value_element').removeClass('bold_swatch_selected');
                $(e.target).closest('.bold_option_value_element').addClass('bold_swatch_selected');
              },
              settesaccss: function(e,value, product){
                $(e.target).closest('.bold_option_value_element').addClass('bold_swatch_selected');

                for(var i=0; i < this.AddTeaAccessories.length; i++){
                  if( this.AddTeaAccessories[i].title == product.name){
                    $(e.target).closest('.bold_option_value_element').removeClass('bold_swatch_selected');
                    this.AddTeaAccessories.splice(i, 1);
                    return false;
                  }else{

                  }
                }
                var obj={
                  title:product.name,
                  img: product.image,
                  price: product.price*100,
                  id: product.id,
                  variants_id: product.variant_id,
                  variant_title: product.variant_title

                };
                this.AddTeaAccessories.push(obj);
               // console.log(this.AddTeaAccessories);
              },
              addtocart: function(e) {
                document.dispatchEvent(new CustomEvent("theme:loading:start"));
                if(this.selecteditmno == this.size){
                  var proprty={};
                  if(this.NameBox != ''){
                   proprty['Name on the Box']=this.NameBox;
                  }
                  if(this.Box_Color != ''){
                    proprty['Box Color']=this.Box_Color;
                  }
                  
                  var allitmes = [];
                  // for(var i=0; i < this.AddTeaAccessories.length; i++){
                  //   var ind = i*1+1*1;
                  //   allitmes[ind] = {id: this.AddTeaAccessories[i].variants_id, quantity:1};
                  //   if(i == 0){
                  //     proprty['Add Tea Accessories']=this.AddTeaAccessories[i].title;
                  //     proprty['_AProductIds']=this.AddTeaAccessories[i].id;
                  //     proprty['_AVariantIds']= this.AddTeaAccessories[i].variants_id;
                  //     proprty['_AVariantNames']=this.AddTeaAccessories[i].title;
                  //     proprty['_AVariantPrices']= this.AddTeaAccessories[i].price;
                  //   }else{
                  //     proprty['Add Tea Accessories']+=','+this.AddTeaAccessories[i].title;
                  //     proprty['_AProductIds']+=','+this.AddTeaAccessories[i].id;
                  //     proprty['_AVariantIds']+=','+ this.AddTeaAccessories[i].variants_id;
                  //     proprty['_AdVariantNames']+=','+this.AddTeaAccessories[i].title;
                  //     proprty['_AVariantPrices']+=','+this.AddTeaAccessories[i].price;
                  //   }
                  // }
                  var that = this;
                  for(var i=0; i < this.selectedproduct.length; i++){
                    var key='Item '+(i+1);
                    proprty[key]=this.selectedproduct[i].title;
                  }
                  //                             proprty['_AProductIds']= "4598117531694,4506254245934,4506743636014";
                  //                             proprty['_AVariantIds']= "32416640237614,32008041955374,32010051321902";
                  //                             proprty['_AVariantNames']="Tiffany Blue,Monroe Glass Cup Infuser,On-the-go Glass Bottle Infuser";
                  //                             proprty['_AVariantPrices']= "1000,5800,8500";
                  //  console.log(proprty);

                  // var myJSON = JSON.stringify(proprty);
                 // allitmes[allitmes.length] = { id: this.Box_Color_id, quantity: 1};
                  

                  allitmes[0] = {
                    quantity: 1,
                    id: this.variant_id,
                    properties: proprty
                  };
                  console.log(this.CustomTubes);
                  if(this.CustomTubes){
                    proprty['Custom Tubes']=$('#utf8').val();
                    allitmes[allitmes.length] = { id: 39943652835374, quantity: 1};
                  }
                  
                  console.log(allitmes);
                  jQuery.post('/cart/add.js', {items: allitmes}).done(
                    function(response){
                      document.dispatchEvent(new CustomEvent("theme:loading:end"));
                      that.proprty=[];
                      // $('a[data-drawer-id="sidebar-cart"]').trigger('click');
                      // $('#sidebar-cart').attr('aria-hidden', 'false');
                      // e.target.innerText = "ADD TO CART";
                      // location.reload();
                      jQuery.get('/cart?view=drawer', function(response) {
                        $('#sidebar-cart').remove();
                        $('body').prepend(response);
                        $('#sidebar-cart').attr('aria-hidden', false);
                        $('.PageOverlay').addClass('is-visible');
                        $('#sidebar-cart').attr('tabindex', '-1');
                        $('.supports-sticky').addClass('no-scroll');
                      });

                      //  $('#sidebar-cart').css('visibility', 'visible');

                      // $('#sidebar-cart').css('right', '396px');
                      // $('#sidebar-cart').css('height', '100vh');
                      // window.location.href="/pages/success?product_name="+that.product_name;
                    }
                  ).fail(
                    function(jqXHR, textStatus, errorThrown) {
                      //               e.target.innerText = "ADD TO CART";
                      //               if(jqXHR.status ==200){
                      //               	console.log(that.product_name);
                      //               	window.location.href="/pages/success?product_name="+that.product_name;
                      //               }
                    }
                  );
                }
              },
      showNameOfBox: function(e){
        console.log(e.target.checked);
        if(e.target.checked == true){
          $('.bold_option.bold_option_textbox').show();
        }else{
          $('.bold_option.bold_option_textbox').hide();
        }
        this.checkBox = e.target.checked;
      },
  }
  });

</script>
<script>
  $('body').on('click', '.Drawer__Close', function(){
    console.log("gg");
  	$('#sidebar-cart').attr('aria-hidden', true);
    $('.PageOverlay').removeClass('is-visible');
    $('.supports-sticky').removeClass('no-scroll');
    $("#sidebar-cart").removeAttr("tabindex");
  });
  $('body').on('click', 'a[data-drawer-id="sidebar-cart"]', function(){
  	$('#sidebar-cart').attr('aria-hidden', false);
  });
  $('body').on('click', '.QuantitySelector__Button', function(){
  	var quantity = $(this).attr('data-quantity');
    console.log(quantity);
  });
 
</script>

{% schema %}
  {
    "name": "Build Box",
    "class": "build-box-main-section",
    "settings": [
		{
			"type":"header",
			"content":"Step II"
		},
		{
			"type":"text",
			"id":"step2",
			"label":"Step 2 Heading",
			"default":"STEP TWO"
		},
		{
			"type":"richtext",
			"id":"step2_content",
			"label":"Step 2 Content",
"default":"<p>Start creating the perfect box! Use the filter if you are looking for something particular.</p>"
		},
		{
			"type":"collection",
			"id":"c1",
			"label":"collection 1"
		},
		{
			"type":"collection",
			"id":"c2",
			"label":"collection 2"
		},
		{
			"type":"collection",
			"id":"c3",
			"label":"collection 3"
		},
		{
			"type":"collection",
			"id":"c4",
			"label":"collection 4"
		},
		{
			"type":"collection",
			"id":"c5",
			"label":"collection 5"
		},
        {
			"type":"collection",
			"id":"c6",
			"label":"collection 6"
		},
        {
			"type":"collection",
			"id":"c7",
			"label":"collection 7"
		},
        {
			"type":"collection",
			"id":"c8",
			"label":"collection 8"
		},
		{
			"type":"header",
			"content":"Step III"
		},
		{
			"type":"text",
			"id":"step3",
			"label":"Step 3 Heading",
			"default":"STEP THREE"
		},
		{
			"type":"richtext",
			"id":"step3_content",
			"label":"Step 3 Content",
			"default":"<p>Why not add a special card, or personalise your box? You can leave your message for the card in step 3 </p><p>(If you have ordered a photo product please email your photo to rob@treatboxuk.com quoting your order number)</p>"
		},
		{
			"type":"collection",
			"id":"a_c",
			"label":"Accessories Collection"
		}
	]
  }
{% endschema %}
